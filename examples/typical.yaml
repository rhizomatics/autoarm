autoarm:
  alarm_panel:
    alias: Virtual control panel using Manual Alarm Control Panel integration
    entity_id: alarm_panel.testing
  occupancy:
    entity_id:
      - person.house_owner
      - person.tenant
    default_state:
      day: disarmed
      night: armed_night
  diurnal:
    sunrise:
      earliest: "06:30:00"
  transitions:
    armed_home:
      alias: Home with alarm active, such as home alone
      conditions:
        - "{{ autoarm.occupied and not autoarm.night }}"
        - "{{ autoarm.computed and autoarm.occupied_daytime_state == 'armed_home'}}"
    armed_away:
      conditions: "{{ not autoarm.occupied and autoarm.computed}}"
    disarmed:
      conditions:
       - "{{ autoarm.occupied and not autoarm.night }}"
       - "{{ autoarm.computed and autoarm.occupied_daytime_state == 'disarmed'}}"
    armed_night:
      conditions: "{{ autoarm.occupied and autoarm.night and autoarm.computed }}"
    pending:
      conditions:
  calendar_control:
    no_event_mode: auto
    calendars:
      - entity_id: calendar.alarm_control
        alias: Local Calendar only used for autoarm
        poll_interval: 60
        state_patterns:
          disarmed:
            - Disarmed
      - entity_id: calendar.family_events
        poll_interval: 300
        state_patterns:
          armed_vacation:
            - Holiday.*
            - Camping Trip.*
          armed_away:
            - Working at Office

  buttons:
    reset:
      entity_id: binary_sensor.button_right
    armed_away:
      delay_time: 180
      entity_id:
        - binary_sensor.button_right
        - binary_sensor.back_door_away
    disarmed:
      entity_id: binary_sensor.button_middle

  rate_limit:
    max_calls: 5
    period: 60

  notify:
    common:
      service: notify.send_message
      data:
        actions:
          - action: ALARM_PANEL_DISARM
            title: Disarm Alarm Panel
            icon: sfsymbols:bell.slash
          - action: ALARM_PANEL_RESET
            title: Reset Alarm Panel
            icon: sfsymbols:bell
          - action: ALARM_PANEL_AWAY
            title: Arm Alarm Panel for Going Away
            icon: sfsymbols:airplane
    quiet:
      data:
        priority: low
    normal:
      data:
        priority: medium
